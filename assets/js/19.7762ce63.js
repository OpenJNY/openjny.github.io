(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{212:function(t,e,r){"use strict";r.r(e);var a=r(1),o=Object(a.a)({},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("p",[r("a",{attrs:{href:"https://www.microsoft.com/en-us/research/blog/open-source-library-provides-explanation-for-machine-learning-through-diverse-counterfactuals/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Open-source library provides explanation for machine learning through diverse counterfactuals"),r("OutboundLink")],1),t._v(" を読んだのでそのまとめです。")]),t._v(" "),r("h2",{attrs:{id:"はじめに"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#はじめに"}},[t._v("#")]),t._v(" はじめに")]),t._v(" "),r("p",[t._v("この記事を一言で要約すると、反実仮想的な説明に基づく機械学習モデル解釈手法に対する Microsoft Research の取り組みと、その成果 (アルゴリズム) を実装した Python ライブラリ "),r("strong",[t._v("DiCE")]),t._v(" の紹介記事です。")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/127839/eb79aae3-b36e-38d4-ad1c-ef8e9aa81f40.png",alt:"image.png"}})]),t._v(" "),r("h2",{attrs:{id:"記事の要約"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#記事の要約"}},[t._v("#")]),t._v(" 記事の要約")]),t._v(" "),r("ul",[r("li",[t._v("昨今のブラックボックス機械学習モデルの解釈手法 (e.g. LIME) は、予測の理由にのみ注意が向けられており、"),r("strong",[t._v("反実仮想 (counterfactuals)")]),t._v(" を考慮できていない\n"),r("ul",[r("li",[t._v("例えば、銀行からローンが借りれなかった人が「なぜ借りれなかったか？」や「あなたのどういう特性を見て貸与しなかったか」は言える")]),t._v(" "),r("li",[t._v("しかし「これからどういう状態になれば借りれるのか？」という未来の意思決定に直接関わる情報を言及できない")])])]),t._v(" "),r("li",[t._v("そこで、"),r("strong",[t._v("反実仮想的な説明 (counterfactual explanation)")]),r("sup",{staticClass:"footnote-ref"},[r("a",{attrs:{href:"#fn1",id:"fnref1"}},[t._v("[1]")])]),t._v(" を出力するアルゴリズムが必要\n"),r("ul",[r("li",[t._v("あるサンプルの反実仮想的な説明 = 狙った出力結果となる、似たようなサンプル (代替案)")]),t._v(" "),r("li",[t._v("反実仮想的説明は、サンプルの perturbation"),r("sup",{staticClass:"footnote-ref"},[r("a",{attrs:{href:"#fn2",id:"fnref2"}},[t._v("[2]")])]),t._v(" であることから"),r("strong",[t._v("敵対的サンプル (adversarial examples)")]),t._v(" に近い概念のものだが、意思決定/現実世界の制約のために、特徴の部分集合を変更してはいけない要請 (e.g. 年齢は変わらない) が存在する点が大きく異なる")]),t._v(" "),r("li",[t._v("ref: "),r("a",{attrs:{href:"https://arxiv.org/abs/1711.00399",target:"_blank",rel:"noopener noreferrer"}},[t._v("Counterfactual Explanations without Opening the Black Box: Automated Decisions and the GDPR"),r("OutboundLink")],1)])])]),t._v(" "),r("li",[t._v("Microsoft Research はこの問題に対し、"),r("strong",[t._v("有益な反実仮想サンプルを列挙するフレームワーク")]),t._v("を提案 "),r("a",{attrs:{href:"https://www.microsoft.com/en-us/research/publication/explaining-machine-learning-classifiers-through-diverse-counterfactual-examples/",target:"_blank",rel:"noopener noreferrer"}},[t._v("(ACM FAT 2020)"),r("OutboundLink")],1),t._v(" "),r("ul",[r("li",[t._v("まずはじめに、反実仮想を考えても良い特徴の値を変えつつ、それと同時に元サンプルとの近さも保つような"),r("strong",[t._v("同時最適化問題を定式化")]),t._v("し、これにより大量の仮想サンプルを生成する (両者のトレードオフを調整する機能も提供)")]),t._v(" "),r("li",[t._v("さらに、反実仮想サンプルの"),r("strong",[t._v("有益性")]),t._v("を図る指標も開発\n"),r("ul",[r("li",[t._v("良い反実仮想サンプル = そのサンプルで学習させた単純な機械学習モデル (e.g. k-NN) によって、局所的に元の機械学習モデルを近似できる")])])])])]),t._v(" "),r("li",[t._v("課題\n"),r("ul",[r("li",[t._v("応用のドメインに応じて反実仮想サンプル生成を調節する方法を考えないといけない")]),t._v(" "),r("li",[t._v("特に"),r("strong",[t._v("特徴量間の因果関係")]),t._v("を陽に扱う手法が重要\n"),r("ul",[r("li",[t._v("そうでなければ、例えば「年を取らずに学歴を積め👊」みたいなサンプルが出力されてしまう")]),t._v(" "),r("li",[t._v('NeurIPS 2019 の Workshop  "Do the right thing": machine learning and causal inference for improved decision making '),r("a",{attrs:{href:"http://tripods.cis.cornell.edu/neurips19_causalml/",target:"_blank",rel:"noopener noreferrer"}},[t._v("[link]"),r("OutboundLink")],1),t._v(" で、今後のための問題を提起")])])])])]),t._v(" "),r("li",[t._v("実装に関して\n"),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/microsoft/DiCE",target:"_blank",rel:"noopener noreferrer"}},[t._v("DiCE (Diverse Counterfactual Explanations)"),r("OutboundLink")],1),t._v(" という名前の Python パッケージで実装を公開")]),t._v(" "),r("li",[t._v("現在はモデルとして Tensorflow しか入力出来ないが、将来的に PyTorch/sckit-learn も扱えるように動いている"),r("sup",{staticClass:"footnote-ref"},[r("a",{attrs:{href:"#fn3",id:"fnref3"}},[t._v("[3]")])])]),t._v(" "),r("li",[t._v("将来的に "),r("a",{attrs:{href:"https://github.com/interpretml/interpret-community",target:"_blank",rel:"noopener noreferrer"}},[t._v("InterpretML"),r("OutboundLink")],1),t._v(" や Azure AutoML と統合される予定")])])])]),t._v(" "),r("h2",{attrs:{id:"dice"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#dice"}},[t._v("#")]),t._v(" DiCE")]),t._v(" "),r("p",[t._v("GitHub: "),r("a",{attrs:{href:"https://github.com/microsoft/DiCE",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/microsoft/DiCE"),r("OutboundLink")],1)]),t._v(" "),r("h3",{attrs:{id:"インストール"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#インストール"}},[t._v("#")]),t._v(" インストール")]),t._v(" "),r("p",[t._v("DiCE のインストールは pip で "),r("code",[t._v("setup.py")]),t._v(" を実行する方法しか今 (2020-02-01) の所ありません。")]),t._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/microsoft/DiCE.git dice\n"),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" dice\npip "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n")])])]),r("p",[t._v("注意点として TensorFlow 1.13 で開発を行っているようで、まだ 2.x には対応していません。")]),t._v(" "),r("h3",{attrs:{id:"チュートリアル"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#チュートリアル"}},[t._v("#")]),t._v(" チュートリアル")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://github.com/microsoft/DiCE/tree/master/notebooks",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/microsoft/DiCE/tree/master/notebooks"),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("公式で 3 つのチュートリアル (jupyter notebook) が公開されています。\nそれぞれの notebook へのリンク、colab で開くリンク、簡単な説明を記しておきます。")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/microsoft/DiCE/blob/master/notebooks/DiCE_getting_started.ipynb",target:"_blank",rel:"noopener noreferrer"}},[t._v("DiCE_getting_started.ipynb"),r("OutboundLink")],1),t._v(" ["),r("a",{attrs:{href:"https://colab.research.google.com/github/microsoft/DiCE/blob/master/notebooks/DiCE_getting_started.ipynb",target:"_blank",rel:"noopener noreferrer"}},[t._v("colab"),r("OutboundLink")],1),t._v("]:\n"),r("ul",[r("li",[t._v("DiCE の API 利用方法の簡単な レクチャー")])])]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/microsoft/DiCE/blob/master/notebooks/DiCE_with_advanced_options.ipynb",target:"_blank",rel:"noopener noreferrer"}},[t._v("DiCE_with_advanced_options.ipynb"),r("OutboundLink")],1),t._v(" ["),r("a",{attrs:{href:"https://colab.research.google.com/github/microsoft/DiCE/blob/master/notebooks/DiCE_with_advanced_options.ipynb",target:"_blank",rel:"noopener noreferrer"}},[t._v("colab"),r("OutboundLink")],1),t._v("]:\n"),r("ul",[r("li",[t._v("feasibility を考慮した perturbation (特徴量の変化量についての重み付け)")])])]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/microsoft/DiCE/blob/master/notebooks/DiCE_with_private_data.ipynb",target:"_blank",rel:"noopener noreferrer"}},[t._v("DiCE_with_private_data.ipynb"),r("OutboundLink")],1),t._v(" ["),r("a",{attrs:{href:"https://colab.research.google.com/github/microsoft/DiCE/blob/master/notebooks/DiCE_with_private_data.ipynb",target:"_blank",rel:"noopener noreferrer"}},[t._v("colab"),r("OutboundLink")],1),t._v("]:\n"),r("ul",[r("li",[t._v("訓練データがなく学習済みモデルしか存在しない場合の反実仮想サンプル生成")])])])]),t._v(" "),r("p",[t._v("colab で開く際は、最初に以下の 2 つのセルを実行してください。")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("%tensorflow_version 1.x\n")])])]),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("!git clone https://github.com/microsoft/DiCE.git dice && cd dice && pip install .\n")])])]),r("h3",{attrs:{id:"roadmap"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#roadmap"}},[t._v("#")]),t._v(" Roadmap")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://microsoft.github.io/DiCE/includeme.html#roadmap",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://microsoft.github.io/DiCE/includeme.html#roadmap"),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("今後の開発ロードマップとして、PyTorch や scikit-learn モデルへの対応や、新たな反実仮想サンプル生成アルゴリズムの実装、因果関係を考慮した手法の組み込み等がドキュメントに記されています。")]),t._v(" "),r("blockquote",[r("p",[t._v("We are working on adding the following features to DiCE:")]),t._v(" "),r("ul",[r("li",[t._v("Support for PyTorch and scikit-learn models")]),t._v(" "),r("li",[t._v("Support for using DiCE for debugging machine learning models")]),t._v(" "),r("li",[t._v("Support for other algorithms for generating counterfactual explanations")]),t._v(" "),r("li",[t._v("Incorporating causal constraints when generating counterfactual explanations")])])]),t._v(" "),r("h2",{attrs:{id:"所感"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#所感"}},[t._v("#")]),t._v(" 所感")]),t._v(" "),r("p",[t._v("機械学習モデルの解釈手法も成熟してきつつあり、"),r("a",{attrs:{href:"https://www.slideshare.net/SatoshiHara3",target:"_blank",rel:"noopener noreferrer"}},[t._v("原先生"),r("OutboundLink")],1),t._v(" の "),r("a",{attrs:{href:"https://www.aaai.org/ocs/index.php/AAAI/AAAI17/paper/viewFile/14304/14364",target:"_blank",rel:"noopener noreferrer"}},[t._v("Lasso 解列挙手法 [AAAI 2017]"),r("OutboundLink")],1),t._v(" のような、解釈した先の意識決定を意識するフェーズに来ているのかなと思いました。\nそのような方法の一つとして、反実仮想的な説明/反実仮想サンプルの着想は非常に理にかなっており、今後も発展が期待されます。\nただ、ライブラリ実装がまだ豊富ではなさそうなので、その辺りの進展が望まれるところですね。")]),t._v(" "),r("h2",{attrs:{id:"参考文献"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#参考文献"}},[t._v("#")]),t._v(" 参考文献")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://www.microsoft.com/en-us/research/blog/open-source-library-provides-explanation-for-machine-learning-through-diverse-counterfactuals/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Open-source library provides explanation for machine learning through diverse counterfactuals - Microsoft Research"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://arxiv.org/abs/1711.00399",target:"_blank",rel:"noopener noreferrer"}},[t._v("[1711.00399] Counterfactual Explanations without Opening the Black Box: Automated Decisions and the GDPR"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.microsoft.com/en-us/research/publication/explaining-machine-learning-classifiers-through-diverse-counterfactual-examples/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Explaining Machine Learning Classifiers through Diverse Counterfactual Examples - Microsoft Research"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/microsoft/dice",target:"_blank",rel:"noopener noreferrer"}},[t._v("microsoft/DiCE: Generate Diverse Counterfactual Explanations for any machine learning model."),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"http://tripods.cis.cornell.edu/neurips19_causalml/",target:"_blank",rel:"noopener noreferrer"}},[t._v("NeurIPS19 CausalML | Cornell TRIPODS Center for Data Science for Improved Decision Making"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://qiita.com/irisu-inwl/items/a4d44efa81935884c725",target:"_blank",rel:"noopener noreferrer"}},[t._v("colabでLIMEとSP-LIMEを動かす。 - Qiita"),r("OutboundLink")],1)]),t._v(" "),r("li",[r("a",{attrs:{href:"https://www.slideshare.net/SatoshiHara3/ss-126157179",target:"_blank",rel:"noopener noreferrer"}},[t._v("機械学習モデルの判断根拠の説明"),r("OutboundLink")],1)])]),t._v(" "),r("hr",{staticClass:"footnotes-sep"}),t._v(" "),r("section",{staticClass:"footnotes"},[r("ol",{staticClass:"footnotes-list"},[r("li",{staticClass:"footnote-item",attrs:{id:"fn1"}},[r("p",[t._v("独自の訳です "),r("a",{staticClass:"footnote-backref",attrs:{href:"#fnref1"}},[t._v("↩︎")])])]),t._v(" "),r("li",{staticClass:"footnote-item",attrs:{id:"fn2"}},[r("p",[t._v("一部/あるいはすべての特徴量の値を微妙に変化させること "),r("a",{staticClass:"footnote-backref",attrs:{href:"#fnref2"}},[t._v("↩︎")])])]),t._v(" "),r("li",{staticClass:"footnote-item",attrs:{id:"fn3"}},[r("p",[t._v("Documentation の "),r("a",{attrs:{href:"https://microsoft.github.io/DiCE/includeme.html#roadmap",target:"_blank",rel:"noopener noreferrer"}},[t._v("Roadmap"),r("OutboundLink")],1),t._v(" を参照 "),r("a",{staticClass:"footnote-backref",attrs:{href:"#fnref3"}},[t._v("↩︎")])])])])])])}),[],!1,null,null,null);e.default=o.exports}}]);